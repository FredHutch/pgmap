<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>getting_started • gimap</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="getting_started">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gimap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting_started.html">getting_started</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/FredHutch/gimap/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>getting_started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FredHutch/gimap/blob/main/vignettes/getting_started.Rmd" class="external-link"><code>vignettes/getting_started.Rmd</code></a></small>
      <div class="hidden name"><code>getting_started.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="gimap-tutorial">gimap tutorial<a class="anchor" aria-label="anchor" href="#gimap-tutorial"></a>
</h2>
<p>gimap performs analysis of dual-targeting CRISPR screening data, with
the goal of aiding the identification of genetic interactions
(e.g. cooperativity, synthetic lethality) in models of disease and other
biological contexts. gimap analyzes functional genomic data generated by
the pgPEN (paired guide RNAs for genetic interaction mapping) approach,
quantifying growth effects of single and paired gene knockouts upon
application of a CRISPR library. A multitude of CRISPR screen types can
be used for this analysis, with helpful descriptions found in this
review (<a href="https://www.nature.com/articles/s43586-021-00093-4" class="external-link uri">https://www.nature.com/articles/s43586-021-00093-4</a>). Use
of pgPEN and GI-mapping in a paired gRNA format can be found here (<a href="https://pubmed.ncbi.nlm.nih.gov/34469736/" class="external-link uri">https://pubmed.ncbi.nlm.nih.gov/34469736/</a>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/FredHutch/gimap" class="external-link">gimap</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'dplyr::group_rows' by</span></span>
<span><span class="co">#&gt; 'kableExtra::group_rows' when loading 'gimap'</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<p>First let’s create a folder we will save files to.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_dir</span> <span class="op">&lt;-</span> <span class="st">"output_data"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">output_dir</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data-requirements">Data requirements<a class="anchor" aria-label="anchor" href="#data-requirements"></a>
</h3>
<p>Let’s examine this example pgPEN counts table. It’s divided into
columns containing:</p>
<ul>
<li>
<code>id</code>: an ID corresponding to the names of paired
guides</li>
<li>
<code>seq_1</code>: gRNA sequence 1, targeting “paralog A”</li>
<li>
<code>seq_2</code>: gRNA sequence 2, targeting “paralog B”</li>
<li>
<code>Day00_RepA</code>: Gene Counts from Day 00 for Replicate
A</li>
<li>
<code>Day05_RepA</code>: Gene Counts from Day 05 for Replicate
A</li>
<li>
<code>Day22_RepA</code>: Gene Counts from Day 22 for Replicate
A</li>
<li>
<code>Day22_RepB</code>: Gene Counts from Day 22 for Replicate
B</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_example_data.html">get_example_data</a></span><span class="op">(</span><span class="st">"count"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">33170</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (3): id, seq_1, seq_2</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (5): Day00_RepA, Day05_RepA, Day22_RepA, Day22_RepB, Day22_RepC</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre></div>
<p>The metadata you have may vary slightly from this but you’ll want to
make sure you have the essential variables and information regarding how
you collected your data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "id"         "seq_1"      "seq_2"      "Day00_RepA" "Day05_RepA"</span></span>
<span><span class="co">#&gt; [6] "Day22_RepA" "Day22_RepB" "Day22_RepC"</span></span></code></pre></div>
<p>This count data has …</p>
<p>We also want the construct metadata</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_pg_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_example_data.html">get_example_data</a></span><span class="op">(</span><span class="st">"meta"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">33170</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (9): pgRNA_ID, target1_sgRNA_seq, target2_sgRNA_seq, paralog_pair, targe...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">example_pg_metadata</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "pgRNA_ID"           "target1_sgRNA_seq"  "target2_sgRNA_seq" </span></span>
<span><span class="co">#&gt; [4] "paralog_pair"       "target_type"        "target1"           </span></span>
<span><span class="co">#&gt; [7] "target2"            "target1_ensembl_id" "target2_ensembl_id"</span></span></code></pre></div>
<p>And the meta data has …</p>
</div>
<div class="section level3">
<h3 id="setting-up-data">Setting up data<a class="anchor" aria-label="anchor" href="#setting-up-data"></a>
</h3>
<p>We’re going to set up three datasets. Two are required; the first is
the counts that the genetic interaction analysis will be used for.</p>
<p>The first data set contains the read counts from each sample type.
Required for analysis is a Day 0 (or plasmid) sample, and at least one
further timepoint sample. The T0 sample, or plasmid sample, will
represent the entire library before any type of selection has occurred
during the length of the screen. This is the baseline for guide RNA
representation. The length of time cells should remain in culture
throughout the screen is heavily dependent on the type of selection
occurring, helpful advice can be found in (<a href="https://www.nature.com/articles/s43586-021-00093-4" class="external-link uri">https://www.nature.com/articles/s43586-021-00093-4</a>). QC
analysis will follow to correlate replicates if inputted. Comparison of
early and late timepoints is possible in this function, but not required
if early timepoints were not taken.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_counts</span> <span class="op">&lt;-</span> <span class="va">example_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Day00_RepA"</span>, <span class="st">"Day05_RepA"</span>, <span class="st">"Day22_RepA"</span>, <span class="st">"Day22_RepB"</span>, <span class="st">"Day22_RepC"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The next datasets are metadata that describe the dimensions of the
count data. - These both need to be data frames. - The sizes of these
metadata must correspond to the dimensions of the counts data.</p>
<p><code>pg_id</code> are just the unique IDs listed in the same
order/sorted the same way as the count data and can be used for mapping
between the count data and the metadata.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_pg_id</span> <span class="op">&lt;-</span> <span class="va">example_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">)</span></span></code></pre></div>
<p>One of these (<code>example_pg_metadata</code>) is required because
it is necessary to know the IDs and be able to map them to pgRNA
constructs.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_pg_metadata</span> <span class="op">&lt;-</span> <span class="va">example_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"seq_1"</span>, <span class="st">"seq_2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Sample metadata is the information that describes the samples and is
sorted the same order as the columns in the count data.</p>
<p>You need to have two columns in the metadata you provide (they must
be named exactly this).</p>
<ul>
<li>
<code>col_names</code> - Must match the colnames of the counts data
being submitted</li>
<li>
<code>timepoints</code> - A numeric variable that describes the
timepoints for these data.</li>
<li>
<code>replicates</code> - A factor that describes which columns are
replicates of each other. It doesn’t matter what you name these except
that this column is a factor that will be used for calculations.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_sample_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Day00_RepA"</span>, <span class="st">"Day05_RepA"</span>, <span class="st">"Day22_RepA"</span>, <span class="st">"Day22_RepB"</span>, <span class="st">"Day22_RepC"</span><span class="op">)</span>,</span>
<span>  day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"5"</span>, <span class="st">"22"</span>, <span class="st">"22"</span>, <span class="st">"22"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RepA"</span>, <span class="st">"RepA"</span>, <span class="st">"RepA"</span>, <span class="st">"RepB"</span>, <span class="st">"RepC"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We’ll need to provide <code>example_counts</code>,
<code>pg_ids</code> and <code>pg_metadata</code> to
<code><a href="../reference/setup_data.html">setup_data()</a></code>. We can provide <code>sample_metadata</code>,
but it is not required at the moment.</p>
<p>Now let’s setup our data using <code><a href="../reference/setup_data.html">setup_data()</a></code>. Optionally
we can provide the metadata in this function as well so that it is
stored with the data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gimap_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setup_data.html">setup_data</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">example_counts</span>,</span>
<span>                            pg_ids <span class="op">=</span> <span class="va">example_pg_id</span>,</span>
<span>                            pg_metadata <span class="op">=</span> <span class="va">example_pg_metadata</span>,</span>
<span>                            sample_metadata <span class="op">=</span> <span class="va">example_sample_metadata</span><span class="op">)</span></span></code></pre></div>
<p>You’ll notice that this set up gives us a list of formatted data.
This contains the original counts we gave <code><a href="../reference/setup_data.html">setup_data()</a></code>
function but also normalized counts, and the total counts per
sample.</p>
<ul>
<li>
<code>raw_counts</code>: The original counts data that illustrates
the number of cells alive in the sample. This data has samples as the
columns and the paired guide constructs as rows.</li>
<li>
<code>counts_per_sample</code>: Add up all the counts for each
sample over all of the paired guide designs.</li>
<li>Transformed data: This section contains the various types of
normalized and adjusted data made from the raw counts data.</li>
<li>
<code>count_norm</code> - For each sample, the data is normalized
<code>-log10(( counts +1) /  total counts for the sample over all the pg designs ))</code>
</li>
<li>
<code>cpm</code> - For each sample this is calculated by taking the
<code>counts / total counts for the sample over all the pg designs)*1e6</code>
</li>
<li>
<code>log2cpm</code>: log-2 transformed counts per million this is
calculated by <code>log2(cpms + 1)</code>
</li>
<li>pg_metadata: paired guide metadata - information that describes the
paired-guided RNA designs. This may include the sequences used in the
CRISPR design as well as what genes are targeted.</li>
<li>
<code>sample_metadata</code>: Metadata that describes the samples.
This likely includes the time point information, replicates, sample IDs,
and any other additional information that is needed regarding the
experimental setup.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">gimap_dataset</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 9</span></span>
<span><span class="co">#&gt;  $ raw_counts       : num [1:33170, 1:5] 951 1511 191 588 289 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "Day00_RepA" "Day05_RepA" "Day22_RepA" "Day22_RepB" ...</span></span>
<span><span class="co">#&gt;  $ counts_per_sample: Named num [1:5] 38471205 32028290 29144511 36628141 36448291</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:5] "Day00_RepA" "Day05_RepA" "Day22_RepA" "Day22_RepB" ...</span></span>
<span><span class="co">#&gt;  $ transformed_data :List of 3</span></span>
<span><span class="co">#&gt;   ..$ count_norm: num [1:33170, 1:5] 4.61 4.41 5.3 4.82 5.12 ...</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. .. ..$ : chr [1:5] "Day00_RepA" "Day05_RepA" "Day22_RepA" "Day22_RepB" ...</span></span>
<span><span class="co">#&gt;   ..$ cpm       : num [1:33170, 1:5] 24.72 39.28 4.96 15.28 7.51 ...</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. .. ..$ : chr [1:5] "Day00_RepA" "Day05_RepA" "Day22_RepA" "Day22_RepB" ...</span></span>
<span><span class="co">#&gt;   ..$ log2_cpm  : num [1:33170, 1:5] 4.68 5.33 2.58 4.03 3.09 ...</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. .. ..$ : chr [1:5] "Day00_RepA" "Day05_RepA" "Day22_RepA" "Day22_RepB" ...</span></span>
<span><span class="co">#&gt;  $ metadata         :List of 2</span></span>
<span><span class="co">#&gt;   ..$ pg_ids         : tibble [33,170 × 1] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..$ id: chr [1:33170] "AADAC_AADACL2_pg1" "AADAC_AADACL2_pg10" "AADAC_AADACL2_pg11" "AADAC_AADACL2_pg12" ...</span></span>
<span><span class="co">#&gt;   ..$ sample_metadata:'data.frame':  5 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ col_names: chr [1:5] "Day00_RepA" "Day05_RepA" "Day22_RepA" "Day22_RepB" ...</span></span>
<span><span class="co">#&gt;   .. ..$ day      : num [1:5] 0 5 22 22 22</span></span>
<span><span class="co">#&gt;   .. ..$ rep      : Factor w/ 3 levels "RepA","RepB",..: 1 1 1 2 3</span></span>
<span><span class="co">#&gt;  $ filtered_data    :List of 5</span></span>
<span><span class="co">#&gt;   ..$ filter_step_run       : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ metadata_pg_ids       : NULL</span></span>
<span><span class="co">#&gt;   ..$ transformed_log2_cpm  : NULL</span></span>
<span><span class="co">#&gt;   ..$ removed_pg_ids        : NULL</span></span>
<span><span class="co">#&gt;   ..$ all_reps_zerocount_ids: NULL</span></span>
<span><span class="co">#&gt;  $ annotation       : NULL</span></span>
<span><span class="co">#&gt;  $ normalized_log_fc: NULL</span></span>
<span><span class="co">#&gt;  $ crispr_score     : NULL</span></span>
<span><span class="co">#&gt;  $ results          : NULL</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr [1:2] "list" "gimap_dataset"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="quality-checks">Quality Checks<a class="anchor" aria-label="anchor" href="#quality-checks"></a>
</h3>
<p>The first step is running some quality checks on our data. The
<code><a href="../reference/run_qc.html">run_qc()</a></code> function will create a report we can look at to
assess this.</p>
<p>The report includes several visualizations of raw/unfiltered
data:</p>
<ul>
<li>distribution of normalized counts for each sample. The goal of
determining this distribution is to identify pgRNA counts that are low
at the start of the screen - before any type of phenotypic or growth
selection is occurring, either in the T0 or plasmid sample. These low
abundance pgRNAs should be removed from the analysis. [the goal section
here doesn’t fit my expectations/understanding of this plot.]</li>
<li>histogram of <code>log2cpm</code> values for each individual sample:
this helps users identify samples that do not have a normal distribution
of reads and inform the upcoming filtering steps.</li>
<li>sample correlation heatmap: generates a heatmap using cpm values for
each replicate/sample. This heatmap gives an overview on how similar
samples are. Replicates should correlate well, and cluster together,
while each timepoint sample should be different from the T0. This
analysis will also allow users to identify potential sample swaps, if
correlation scores between replicates is poor.</li>
<li>A histogram that shows the variance within replicates for each pgRNA
construct. For each pgRNA construct, the variance among the 3 replicates
is found and a distribution is constructed by looking at these variances
together.</li>
<li>A histogram of the log2 CPM values of pgRNA constructs at the
plasmid time point. This graph relates to a plasmid filter that can be
applied to the data, but the plot displays all of the data prior to a
filter being applied.</li>
</ul>
<p>This report also includes several visualizations after filters are
applied:</p>
<p>There is a filter that flags pgRNA constructs where any of the time
points have a count of zero. - We include a bar plot that shows the
number of pgRNA constructs which have counts of zero in either 0, 1, 2,
or 3 replicates. - We include a table that specifies how many pgRNAs
would be filtered out by applying this filter.</p>
<p>There is a filter that flags pgRNA constructs that have low log2 CPM
counts for the day 0 or plasmid time point. - The histogram of the log2
CPM values of pgRNA constructs at the plasmid time point mentioned
earlier does have a dashed line specifying the lower outlier (or a user
defined cutoff) and pgRNA constructs with a plasmid log2 CPM lower than
that value can be filtered out. - We include a table that specifies how
many pgRNAs would be filtered out by applying this filter.</p>
<p>There is a filter that flags pgRNA constructs that have low log2 CPM
counts for the day 0 or plasmid time point. - The histogram of the log2
CPM values of pgRNA constructs at the plasmid time point mentioned
earlier does have a dashed line specifying the lower outlier (or a user
defined cutoff) and pgRNA constructs with a plasmid log2 CPM lower than
that value can be filtered out. - We include a table that specifies how
many pgRNAs would be filtered out by applying this filter.</p>
<pre><code><span><span class="fu"><a href="../reference/run_qc.html">run_qc</a></span><span class="op">(</span><span class="va">gimap_dataset</span>,</span>
<span>       output_file <span class="op">=</span> <span class="st">"example_qc_report.Rmd"</span>,</span>
<span>       overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>       quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
<p>You can take a look at an <a href="http://htmlpreview.github.io/?https://raw.githubusercontent.com/FredHutch/gimap/main/inst/example_qc_report.html" class="external-link">example
QC report here</a>.</p>
</div>
<div class="section level3">
<h3 id="filtering-the-data">Filtering the data<a class="anchor" aria-label="anchor" href="#filtering-the-data"></a>
</h3>
<p>After considering the QC report and which filters are
appropriate/desired for your data, you can apply filters to the data
using the <code>gimap_filter</code> function.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gimap_dataset</span> <span class="op">&lt;-</span> <span class="va">gimap_dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/gimap_filter.html">gimap_filter</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Filtered forms of the data can be seen in the
<code>$filtered_data entry</code></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">gimap_dataset</span><span class="op">$</span><span class="va">filtered_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ filter_step_run       : logi TRUE</span></span>
<span><span class="co">#&gt;  $ metadata_pg_ids       : tibble [31,817 × 1] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   ..$ id: chr [1:31817] "AADAC_AADACL2_pg1" "AADAC_AADACL2_pg10" "AADAC_AADACL2_pg11" "AADAC_AADACL2_pg12" ...</span></span>
<span><span class="co">#&gt;  $ transformed_log2_cpm  : num [1:31817, 1:5] 4.68 5.33 2.58 4.03 3.09 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "Day00_RepA" "Day05_RepA" "Day22_RepA" "Day22_RepB" ...</span></span>
<span><span class="co">#&gt;  $ removed_pg_ids        : tibble [1,353 × 2] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   ..$ id             : chr [1:1353] "ABCC1_ABCC3_pg12" "ABHD4_ABHD5_pg3" "ABL1_ABL2_pg12" "ACACA_ACACB_pg13" ...</span></span>
<span><span class="co">#&gt;   ..$ relevantFilters: chr [1:1353] "filter_zero_count" "filter_zero_count" "filter_zero_count" "filter_zero_count" ...</span></span>
<span><span class="co">#&gt;  $ all_reps_zerocount_ids: tibble [159 × 1] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   ..$ id: chr [1:159] "ACSL3_ACSL4_pg15" "ACSL3_ACSL4_pg4" "ACTL6A_ACTL6B_pg5" "ACTL6A_ACTL6B_pg6" ...</span></span></code></pre></div>
<p>Let’s take a look at how many rows of data we have left:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">gimap_dataset</span><span class="op">$</span><span class="va">filtered_data</span><span class="op">$</span><span class="va">transformed_log2_cpm</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 31817</span></span></code></pre></div>
<p>As you can see from the output above, there are fewer pgRNA
constructs in the filtered dataset following completion of
filtering.</p>
<p>The filtering step also stores two tables of information that you may
want to use or report.</p>
<ul>
<li>
<code>$filtered_data$removed_pg_ids</code> is a table that has the
pgRNA construct IDs that are removed following completion of filtering
in the <code>id</code> column and the relevant filter(s) that led to
removal as a comma separated list in the <code>relevantFilters</code>
column</li>
<li>
<code>$filtered_data$all_reps_zerocount_ids</code> is a table that
lists the IDs of pgRNA constructs which had a count of 0 for all final
timepoint replicates. These pgRNA constructs are NOT necessarily
filtered out</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gimap_dataset</span> <span class="op">&lt;-</span> <span class="va">gimap_dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/gimap_annotate.html">gimap_annotate</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/gimap_normalize.html">gimap_normalize</a></span><span class="op">(</span></span>
<span>    timepoints <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>    replicates <span class="op">=</span> <span class="st">"rep"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calc_crispr.html">calc_crispr</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calc_gi.html">calc_gi</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Annotating Data</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">1884</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (3): gene, gene_symbol, entrez_id</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; Normalizing Log Fold Change</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculating CRISPR score</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculating Genetic Interaction scores</span></span></code></pre></div>
<p>Take a look at the results.</p>
<p>Here’s what’s included in the GI Scores table:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gimap_dataset</span><span class="op">$</span><span class="va">gi_scores</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   pgRNA_target_double rep       double_target_gi_score single_target_gi_score_1</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AADAC_AADACL2       late_RepA                  0.465                  -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AADAC_AADACL2       late_RepA                  0.465                  -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> AADAC_AADACL2       late_RepA                  0.465                  -<span style="color: #BB0000;">0.500</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> AADAC_AADACL2       late_RepA                  0.465                  -<span style="color: #BB0000;">0.500</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> AADAC_AADACL2       late_RepB                  0.209                  -<span style="color: #BB0000;">0.418</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> AADAC_AADACL2       late_RepB                  0.209                  -<span style="color: #BB0000;">0.418</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: single_target_gi_score_2 &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Take a look at a preview of the crispr scores:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gimap_dataset</span><span class="op">$</span><span class="va">crispr_score</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 12</span></span></span>
<span><span class="co">#&gt;   target_type rep       double_crispr_score single_crispr_score_1</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> gene_gene   late_RepA               0.913                0.427 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> gene_gene   late_RepA               0.913                0.427 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> gene_gene   late_RepA               0.913               -<span style="color: #BB0000;">0.051</span><span style="color: #BB0000; text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> gene_gene   late_RepA               0.913               -<span style="color: #BB0000;">0.051</span><span style="color: #BB0000; text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> gene_gene   late_RepB               0.767                0.140 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> gene_gene   late_RepB               0.767                0.140 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: single_crispr_score_2 &lt;dbl&gt;, pgRNA_target_double &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   mean_single_target_crispr_1 &lt;dbl&gt;, mean_single_target_crispr_2 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   pgRNA1_seq &lt;chr&gt;, pgRNA2_seq &lt;chr&gt;, mean_double_control_crispr_1 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   mean_double_control_crispr_2 &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Take a look at the overall stats:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gimap_dataset</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">overall</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   rep [3]</span></span></span>
<span><span class="co">#&gt;   rep       term                 estimate std.error statistic   p.value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> late_RepA (Intercept)           -<span style="color: #BB0000;">0.031</span><span style="color: #BB0000; text-decoration: underline;">4</span>    0.011<span style="text-decoration: underline;">7</span>     -<span style="color: #BB0000;">2.69</span> 7.17<span style="color: #949494;">e</span><span style="color: #BB0000;">-  3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> late_RepA mean_expected_crispr   0.766     0.018<span style="text-decoration: underline;">1</span>     42.3  1.45<span style="color: #949494;">e</span><span style="color: #BB0000;">-227</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> late_RepB (Intercept)            0.019<span style="text-decoration: underline;">3</span>    0.010<span style="text-decoration: underline;">7</span>      1.81 7.09<span style="color: #949494;">e</span><span style="color: #BB0000;">-  2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> late_RepB mean_expected_crispr   0.762     0.018<span style="text-decoration: underline;">2</span>     41.9  2.83<span style="color: #949494;">e</span><span style="color: #BB0000;">-224</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> late_RepC (Intercept)           -<span style="color: #BB0000;">0.026</span><span style="color: #BB0000; text-decoration: underline;">3</span>    0.010<span style="text-decoration: underline;">5</span>     -<span style="color: #BB0000;">2.50</span> 1.26<span style="color: #949494;">e</span><span style="color: #BB0000;">-  2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> late_RepC mean_expected_crispr   0.767     0.017<span style="text-decoration: underline;">7</span>     43.4  2.24<span style="color: #949494;">e</span><span style="color: #BB0000;">-234</span></span></span></code></pre></div>
<p>Lastly, let’s take a look at the by target results. We can arrange by
results using <code><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">dplyr::arrange()</a></code></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gimap_dataset</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">by_target</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">fdr_vals_wil_late_RepA</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,030 × 13</span></span></span>
<span><span class="co">#&gt;    targets     p_val_ttest_late_RepA p_val_ttest_late_RepB p_val_ttest_late_RepC</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> CNOT8_CNOT7              3.72<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>            0.000<span style="text-decoration: underline;">019</span>2             0.000<span style="text-decoration: underline;">002</span>76</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> PFN2_PFN1                3.12<span style="color: #949494;">e</span><span style="color: #BB0000;">- 8</span>            0.063<span style="text-decoration: underline;">4</span>                0.004<span style="text-decoration: underline;">98</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> CDKN2B_CDK…              1.05<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>            0.000<span style="text-decoration: underline;">001</span>81            0.000<span style="text-decoration: underline;">002</span>62</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> TIAL1_TIA1               1.37<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>            0.000<span style="text-decoration: underline;">752</span>              0.000<span style="text-decoration: underline;">187</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> IMPDH2_IMP…              2.72<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>            0.027<span style="text-decoration: underline;">6</span>                0.031<span style="text-decoration: underline;">4</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> NDEL1_NDE1               6.85<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span>            0.000<span style="text-decoration: underline;">368</span>              0.000<span style="text-decoration: underline;">151</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> MX2_MX1                  1.98<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>            0.000<span style="text-decoration: underline;">021</span>9             0.055<span style="text-decoration: underline;">1</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> ZNF146_ZNF…              8.39<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>            0.001<span style="text-decoration: underline;">01</span>               0.000<span style="text-decoration: underline;">068</span>7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> COQ10B_COQ…              3.48<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>            0.021<span style="text-decoration: underline;">2</span>                0.001<span style="text-decoration: underline;">71</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> FAM24B_FAM…              5.52<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>            0.006<span style="text-decoration: underline;">79</span>               0.019<span style="text-decoration: underline;">9</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,020 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 9 more variables: p_val_wil_late_RepA &lt;dbl&gt;, p_val_wil_late_RepB &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   p_val_wil_late_RepC &lt;dbl&gt;, fdr_vals_ttest_late_RepA &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   fdr_vals_ttest_late_RepB &lt;dbl&gt;, fdr_vals_ttest_late_RepC &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   fdr_vals_wil_late_RepA &lt;dbl&gt;, fdr_vals_wil_late_RepB &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   fdr_vals_wil_late_RepC &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="saving-results-to-files">Saving results to files<a class="anchor" aria-label="anchor" href="#saving-results-to-files"></a>
</h3>
<p>We can save the genetic interactions scores like this:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_tsv</a></span><span class="op">(</span><span class="va">gimap_dataset</span><span class="op">$</span><span class="va">gi_scores</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"gi_scores.tsv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Similarly let’s save the CRISPR scores.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_tsv</a></span><span class="op">(</span><span class="va">gimap_dataset</span><span class="op">$</span><span class="va">crispr_score</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"crispr_scores.tsv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can extract and save the stats results to the TSV</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_tsv</a></span><span class="op">(</span><span class="va">gimap_dataset</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">overall</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"overall_stats.tsv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_tsv</a></span><span class="op">(</span><span class="va">gimap_dataset</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">by_target</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="st">"by_target_stats.tsv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can save all these data as an RDS.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">gimap_dataset</span>, <span class="st">"gimap_dataset_final.RDS"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h3>
<p>This is just for provenance purposes.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] dplyr_1.1.4 gimap_0.1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] tidyr_1.3.1        sass_0.4.9         utf8_1.2.4         generics_0.1.3    </span></span>
<span><span class="co">#&gt;  [5] xml2_1.3.6         stringi_1.8.4      hms_1.1.3          digest_0.6.36     </span></span>
<span><span class="co">#&gt;  [9] magrittr_2.0.3     evaluate_0.24.0    grid_4.4.1         timechange_0.3.0  </span></span>
<span><span class="co">#&gt; [13] RColorBrewer_1.1-3 fastmap_1.2.0      jsonlite_1.8.8     backports_1.5.0   </span></span>
<span><span class="co">#&gt; [17] purrr_1.0.2        fansi_1.0.6        viridisLite_0.4.2  scales_1.3.0      </span></span>
<span><span class="co">#&gt; [21] textshaping_0.4.0  jquerylib_0.1.4    cli_3.6.3          crayon_1.5.3      </span></span>
<span><span class="co">#&gt; [25] rlang_1.1.4        bit64_4.0.5        munsell_0.5.1      withr_3.0.0       </span></span>
<span><span class="co">#&gt; [29] cachem_1.1.0       yaml_2.3.10        parallel_4.4.1     tools_4.4.1       </span></span>
<span><span class="co">#&gt; [33] tzdb_0.4.0         colorspace_2.1-1   ggplot2_3.5.1      kableExtra_1.4.0  </span></span>
<span><span class="co">#&gt; [37] broom_1.0.6        curl_5.2.1         vctrs_0.6.5        R6_2.5.1          </span></span>
<span><span class="co">#&gt; [41] lifecycle_1.0.4    lubridate_1.9.3    snakecase_0.11.1   stringr_1.5.1     </span></span>
<span><span class="co">#&gt; [45] bit_4.0.5          fs_1.6.4           vroom_1.6.5        ragg_1.3.2        </span></span>
<span><span class="co">#&gt; [49] janitor_2.2.0      pkgconfig_2.0.3    desc_1.4.3         pkgdown_2.1.0     </span></span>
<span><span class="co">#&gt; [53] pillar_1.9.0       bslib_0.8.0        gtable_0.3.5       glue_1.7.0        </span></span>
<span><span class="co">#&gt; [57] systemfonts_1.1.0  xfun_0.46          tibble_3.2.1       tidyselect_1.2.1  </span></span>
<span><span class="co">#&gt; [61] rstudioapi_0.16.0  knitr_1.48         htmltools_0.5.8.1  rmarkdown_2.27    </span></span>
<span><span class="co">#&gt; [65] svglite_2.1.3      readr_2.1.5        pheatmap_1.0.12    compiler_4.4.1</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Candace Savonen, Howard Baek, Kate Isaac.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
