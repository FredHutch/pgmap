---
title: 'pgMAP: Paired Guide RNA Read Mapping from Dual-Targeting CRISPR Screens'
tags:
  - Python
  - bioinformatics
  - genomics
  - CRISPR
authors:
  - name: Marissa H. Fujimoto
    affiliation: "1"
  - name: Candace L. Savonen
    affiliation: "1"
  - name: Siobhan O'Brien
    affiliation: "1"
  - name: Phoebe C.R. Parrish
    affiliation: "1, 2, 3"
  - name: Daniel J. Groso
    affiliation: "1, 2"
  - name: James D. Thomas
    affiliation: "2, 4"
  - name: Robert K. Bradley
    affiliation: "2, 3, 4"
  - name: Alice H. Berger
    affiliation: "1, 2, 3"
    corresponding: True
affiliations:
 - name: Human Biology Division, Fred Hutchinson Cancer Center, Seattle, WA 98109, USA
   index: 1
   ror: 007ps6h72
 - name: Computational Biology Program, Public Health Sciences Division, Fred Hutchinson Cancer Center, Seattle, WA 98109, USA
   index: 2
   ror: 007ps6h72
 - name: Department of Genome Sciences, University of Washington, Seattle, WA 98195, USA
   index: 3
   ror: 00cvxb145
 - name: Basic Sciences Division, Fred Hutchinson Cancer Center, Seattle, WA 98109, USA
   index: 4
   ror: 007ps6h72

date: 3 June 2025
bibliography: paper.bib

---

# Summary

Genetic interactions occur when two or more genes interact to produce a phenotype that differs from the effect of both genes considered independently. Synthetic lethality is a type of genetic interaction between two genes where the loss of either gene is tolerated individually, but the loss of both genes results in a reduction of cell viability. One possible application of synthetic lethality is cancer therapies. The CRISPR-Cas system allows scalable investigation of synthetic lethality directly in lab-cultured human tumor cells. However, current tools for analyzing dual-targeting CRISPR screens, which is the preferred method to study synthetic lethality at scale, are poorly established compared to existing tools for single-targeting CRISPR screens. We present pgMAP (paired guide RNA MAPper): a command line tool built to read paired guide counts from dual-targeting CRISPR screening sequencing data. By quantifying the relative depletion and enrichment of paired guides between different samples, pgMAP enables the discovery of genetic interactions across many organisms, genetic backgrounds, tissues, and cancer types.

# Statement of Need

In recent years, several genome-scale, dual-targeting CRISPR-mediated knockout screening approaches have been developed to map genetic interactions in the human genome [@Dede2020-ks; @Gonatopoulos-Pournatzis2020-mv; @Ito2021-wn; @Koferle2022-rs; @Parrish2021-pd; @Tang2022-dp; @Thompson2021-xv]. These methods enable functional profiling of duplicated gene families and expand the range of potentially targetable synthetic lethal interactions in cancer [@Dandage2021-sp; @Ryan2023-bw]. However, computational methods for genetic interaction mapping from human CRISPR screen data are poorly established, which may impede interpretation of dual-targeting CRISPR screen data and thus prevent identification of actionable synthetic lethal targets.

pgMAP is a command line tool that processes raw sequencing data into tables of counts per genetic perturbation. pgMAP is purpose-built for genetic interaction analysis; rather than utilizing bioinformatics tools designed for general-purpose alignment of DNA sequences, pgMAP exploits the paired structure of dual-targeting CRISPR experiments to efficiently map and count paired guides. Compared to previous approaches, pgMAP produces equivalent results over three times faster while requiring constant memory and disk space relative to the number of reads in the raw sequencing data (\autoref{performance-table}). As a general purpose tool for analyzing paired knockout CRISPR screen data, pgMAP can be configured with parameters including error tolerances and sequencing strategies to suit a wide berth of experimental designs.

| Tool             | Mean (Minutes) | Min (Minutes) | Max (Minutes) | Peak Memory Usage (GB) | Intermediate File(s) Size (GB)|
|------------------|:--------------:|:-------------:|:-------------:|:----------------------:|:-----------------------------:|
| bowtie pipeline* | 72.35          | 71.69         | 72.92         | 0.026                  | 28.64                         |
| pgMAP**          | 22.93          | 22.22         | 24.09         | 0.157                  | N/A                           |

: Performance comparison of pgMAP and bowtie to count paired guides from a pgPEN screen. Fastqs used from “Discovery of synthetic lethal and tumor suppressor paralog pairs in the human genome” by Parrish Et. Al 2021.  Both benchmarks were run using Hyperfine [@Peter_hyperfine_2023] with parameters “--warmup 1 --runs 3” using a Macbook Air M3 with 16 GB of memory. \
*Bowtie was run with version 1.3.1 with parameters “-q -v 1 --best --strata --all --sam -p 8” to align the both guide RNAs sequentially. Intermediate file size refers to the sum of the two bam files generated by piping the output from bowtie into samtools [@10.1093/gigascience/giab008]. A full pipeline built around bowtie would include additional steps for mapping the alignment results into paired guide counts and demultiplexing samples. \label{performance-table} \
**pgMAP was run with the default parameters of gRNA1-error 1, gRNA2-error 1, and barcode-error 1.

# Description of Algorithm

pgMAP’s counting algorithm takes advantage of the structure of paired CRISPR guide libraries. Paired guide libraries are composed of pairs of guide RNA sequences. While the number of unique guide RNA pairs can be in the tens of thousands, there are orders of magnitude fewer unique guide sequences. Therefore, it is possible to directly hash all the guide sequences and efficiently map to them while reading from sequencing data. To support error tolerance, pgMAP hashes every possible error perturbed sequence within an error tolerance of each reference guide sequence. With the suggested error tolerance of a single substitution, pgMAP uses less than 200mb of memory when applied to data generated using the pgPEN CRISPR library, which contains ~33,000 pgRNAs [@Parrish2021-pd].

Compared to an approach using a general purpose aligner like bowtie (citation needed), there is no need to demultiplex individual samples before aligning. Additionally, no intermediate alignment files are generated by pgMAP and no pipeline of bioinformatics tools is necessary to orchestrate individual steps. pgMAP is implemented with Python and depends only on the Levenshtein Python package for string distance calculations [@levenshtein].

![Overview of the pgMAP algorithm. pgMAP first computes and caches every guide RNA (gRNA) in the library annotation along with every tolerated perturbation of each guide. Then the algorithm steps through each sequencing read and trimming and hashes each guide candidate against the reference alignment cache to count guides. Barcode candidates are counted by directly checking each Levenshtein distance to the reference sample barcodes. Finally, the resulting paired guide and sample mappings are exported to a file for subsequent analysis by the user. \label{pgmap-algorithm-diagram}](pgmap-algorithm.svg){width=60%}

# Research Using pgMAP

pgMAP is currently being utilized in ongoing research projects in the Berger lab, including follow-up work to previous paired gRNA CRISPR screens [@Parrish2021-pd].

TODO say something about usage with gimap

# Acknowledgements

M. Fujimoto was supported by the NIH award R25HG012337.

S. O’Brien is a Washington Research Foundation postdoctoral fellow.

This work was supported in part by NCI R01CA262556, the American Cancer Society, and a pilot award from the Fred Hutch Translational Data Science Integrated Research Center.

# References
